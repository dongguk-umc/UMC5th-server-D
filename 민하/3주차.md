## 1. 단방향 연관관계

- 테이블은 `외래키`로 join을 사용해 연관된 테이블을 찾는 반면,
- 객체는 `참조`를 사용해 연관된 객체를 찾는다.

➡️ 이 간극을 해소하기 위해 `객체의 참조`와 `테이블의 외래키`를 매핑하여 연관관계를 나타낸다.

ex)

```java
// Member 엔티티

@ManyToOne
@JoinColumn(name = "TEAM_ID")	// 테이블 외래키 매핑
private Team team;				// 객체 참조
```

<br>

## 2. 양방향 연관관계와 연관관계의 주인

- 테이블에서는 하나의 `외래키`만으로 양방향의 연관관계를 나타낼 수 있는 반면,
- 객체에서 하나의 `참조`는 단방향의 연관관계만 나타낼 수 있다.

➡️ 객체에서 양방향 연관관계를 나타내기 위해선 두 개의 `참조`가 필요하다.

ex)

```java
// Member 엔티티 (주인)

@ManyToOne
@JoinColumn(name = "TEAM_ID")
private Team team;
```

```java
// Team 엔티티

@OneToMany(mappedBy = "team")
private List<Member> members = new ArrayList<>();
```

<br>

양방향 연관관계에서는 `연관관계의 주인`이 필요하다. 일반적으로 다음의 규칙을 따른다.
- 객체의 두 관계 중 하나를 연관관계의 주인으로 지정
- 연관관계의 주인만이 외래키 관리 (등록, 수정)
- 주인이 아닌 객체는 읽기만 가능
- 주인은 mappedBy 속성 사용 불가
- 주인이 아니면 mappedBy 속성으로 주인 지정

➡️ **외래키가 있는 곳, 1:N 중 N 쪽을 주인으로 한다!**

<br>

※ 주의!
- 순수 객체 상태를 고려하여 항상 양쪽에 값을 설정하자.
- 연관관계 편의 메소드를 생성하자.
`연관관계 편의 메소드` 주인 값 설정할 때 나머지 한 쪽도 같이 설정해버리는 메소드
- 양방향 매핑 시 무한 루프를 조심하자.
ex) toString(), lombok, JSON 생성 라이브러리

<br>

## 3. 정리
- 단방향 매핑만으로도 이미 연관관계 매핑은 완료
- 양방향 매핑은 반대 방향으로 조회 기능이 추가된 것에 불과
- JPQL에서 역방향으로 탐색할 일이 많음
- 단방향 매핑을 잘 하고 양방향은 필요할 때 추가해도 됨 (테이블에 영향 주지 않음)

➡️ 기본적으로 1:N 중 N을 주인으로 하여 연관관계 매핑하여 단방향 매핑만으로 설계 끝내고, 양방향 매핑은 개발 단계 들어가서 고민하도록 한다.